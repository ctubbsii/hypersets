CC=gcc
CFLAGS=-Wall -std=c99 -O3 -pedantic -pthread
DEBUG=-DDEBUG -g
SRCS=src/HPC.c
PREFIX=.
BIN=${PREFIX}/bin

all: hpc debug

make-output-dir:
	mkdir -p ${BIN}

hpc: make-output-dir ${SRCS}
	${CC} ${CFLAGS} -o ${BIN}/hpc2 -DLEVEL=2 ${SRCS}
	${CC} ${CFLAGS} -o ${BIN}/hpc3 -DLEVEL=3 ${SRCS}
	${CC} ${CFLAGS} -o ${BIN}/hpc4 -DLEVEL=4 ${SRCS}
	${CC} ${CFLAGS} -o ${BIN}/hpc5 -DLEVEL=5 ${SRCS}
	${CC} ${CFLAGS} -o ${BIN}/hpc6 -DLEVEL=6 ${SRCS}
	${CC} ${CFLAGS} -o ${BIN}/hpc7 -DLEVEL=7 ${SRCS}

debug: make-output-dir ${SRCS}
	${CC} ${CFLAGS} ${DEBUG} -o ${BIN}/hpc2-debug -DLEVEL=2 ${SRCS}
	${CC} ${CFLAGS} ${DEBUG} -o ${BIN}/hpc3-debug -DLEVEL=3 ${SRCS}
	${CC} ${CFLAGS} ${DEBUG} -o ${BIN}/hpc4-debug -DLEVEL=4 ${SRCS}
	${CC} ${CFLAGS} ${DEBUG} -o ${BIN}/hpc5-debug -DLEVEL=5 ${SRCS}
	${CC} ${CFLAGS} ${DEBUG} -o ${BIN}/hpc6-debug -DLEVEL=6 ${SRCS}
	${CC} ${CFLAGS} ${DEBUG} -o ${BIN}/hpc7-debug -DLEVEL=7 ${SRCS}

clean:
	rm -rf ${BIN}/*

benchmark: clean all
	time ${BIN}/hpc2
	time ${BIN}/hpc3
	time ${BIN}/hpc4
	time ${BIN}/hpc5
	time ${BIN}/hpc6

sections: clean
	${CC} ${CFLAGS} -o sec0 -DSECTION=0 -DLEVEL=7 -DCMIN=140737488355328ull   -DCMAX=153931627888511ull ${SRCS}
	${CC} ${CFLAGS} -o sec1 -DSECTION=1 -DLEVEL=7 -DCMIN=153931627888512ull   -DCMAX=167125767421695ull ${SRCS}
	${CC} ${CFLAGS} -o sec2 -DSECTION=2 -DLEVEL=7 -DCMIN=167125767421696ull   -DCMAX=180319906954879ull ${SRCS}
	${CC} ${CFLAGS} -o sec3 -DSECTION=3 -DLEVEL=7 -DCMIN=180319906954880ull   -DCMAX=193514046488063ull ${SRCS}
	${CC} ${CFLAGS} -o sec4 -DSECTION=4 -DLEVEL=7 -DCMIN=193514046488064ull   -DCMAX=206708186021247ull ${SRCS}
	${CC} ${CFLAGS} -o sec5 -DSECTION=5 -DLEVEL=7 -DCMIN=206708186021248ull   -DCMAX=219902325554431ull ${SRCS}
	${CC} ${CFLAGS} -o sec6 -DSECTION=6 -DLEVEL=7 -DCMIN=219902325554432ull   -DCMAX=233096465087615ull ${SRCS}
	${CC} ${CFLAGS} -o sec7 -DSECTION=7 -DLEVEL=7 -DCMIN=233096465087616ull   -DCMAX=246290604620799ull ${SRCS}
	${CC} ${CFLAGS} -o sec8 -DSECTION=8 -DLEVEL=7 -DCMIN=246290604620800ull   -DCMAX=259484744153983ull ${SRCS}
	${CC} ${CFLAGS} -o sec9 -DSECTION=9 -DLEVEL=7 -DCMIN=259484744153984ull   -DCMAX=272678883687167ull ${SRCS}
	${CC} ${CFLAGS} -o sec10 -DSECTION=10 -DLEVEL=7 -DCMIN=272678883687168ull -DCMAX=285873023220351ull ${SRCS}
	${CC} ${CFLAGS} -o sec11 -DSECTION=11 -DLEVEL=7 -DCMIN=285873023220352ull -DCMAX=299067162753535ull ${SRCS}
	${CC} ${CFLAGS} -o sec12 -DSECTION=12 -DLEVEL=7 -DCMIN=299067162753536ull -DCMAX=312261302286719ull ${SRCS}
	${CC} ${CFLAGS} -o sec13 -DSECTION=13 -DLEVEL=7 -DCMIN=312261302286720ull -DCMAX=325455441819903ull ${SRCS}
	${CC} ${CFLAGS} -o sec14 -DSECTION=14 -DLEVEL=7 -DCMIN=325455441819904ull -DCMAX=338649581353087ull ${SRCS}
	${CC} ${CFLAGS} -o sec15 -DSECTION=15 -DLEVEL=7 -DCMIN=338649581353088ull -DCMAX=351843720886271ull ${SRCS}
	${CC} ${CFLAGS} -o sec16 -DSECTION=16 -DLEVEL=7 -DCMIN=351843720886272ull -DCMAX=365037860419455ull ${SRCS}
	${CC} ${CFLAGS} -o sec17 -DSECTION=17 -DLEVEL=7 -DCMIN=365037860419456ull -DCMAX=378231999952639ull ${SRCS}
	${CC} ${CFLAGS} -o sec18 -DSECTION=18 -DLEVEL=7 -DCMIN=378231999952640ull -DCMAX=391426139485823ull ${SRCS}
	${CC} ${CFLAGS} -o sec19 -DSECTION=19 -DLEVEL=7 -DCMIN=391426139485824ull -DCMAX=404620279019007ull ${SRCS}
	${CC} ${CFLAGS} -o sec20 -DSECTION=20 -DLEVEL=7 -DCMIN=404620279019008ull -DCMAX=417814418552191ull ${SRCS}
	${CC} ${CFLAGS} -o sec21 -DSECTION=21 -DLEVEL=7 -DCMIN=417814418552192ull -DCMAX=431008558085375ull ${SRCS}
	${CC} ${CFLAGS} -o sec22 -DSECTION=22 -DLEVEL=7 -DCMIN=431008558085376ull -DCMAX=444202697618559ull ${SRCS}
	${CC} ${CFLAGS} -o sec23 -DSECTION=23 -DLEVEL=7 -DCMIN=444202697618560ull -DCMAX=457396837151743ull ${SRCS}
	${CC} ${CFLAGS} -o sec24 -DSECTION=24 -DLEVEL=7 -DCMIN=457396837151744ull -DCMAX=470590976684927ull ${SRCS}
	${CC} ${CFLAGS} -o sec25 -DSECTION=25 -DLEVEL=7 -DCMIN=470590976684928ull -DCMAX=483785116218111ull ${SRCS}
	${CC} ${CFLAGS} -o sec26 -DSECTION=26 -DLEVEL=7 -DCMIN=483785116218112ull -DCMAX=496979255751295ull ${SRCS}
	${CC} ${CFLAGS} -o sec27 -DSECTION=27 -DLEVEL=7 -DCMIN=496979255751296ull -DCMAX=510173395284479ull ${SRCS}
	${CC} ${CFLAGS} -o sec28 -DSECTION=28 -DLEVEL=7 -DCMIN=510173395284480ull -DCMAX=523367534817663ull ${SRCS}
	${CC} ${CFLAGS} -o sec29 -DSECTION=29 -DLEVEL=7 -DCMIN=523367534817664ull -DCMAX=536561674350847ull ${SRCS}
	${CC} ${CFLAGS} -o sec30 -DSECTION=30 -DLEVEL=7 -DCMIN=536561674350848ull -DCMAX=549755813884031ull ${SRCS}
	${CC} ${CFLAGS} -o sec31 -DSECTION=31 -DLEVEL=7 -DCMIN=549755813884032ull -DCMAX=562949953417215ull ${SRCS}
	${CC} ${CFLAGS} -o sec32 -DSECTION=32 -DLEVEL=7 -DCMIN=562949953417216ull -DCMAX=562949953421311ull ${SRCS}

